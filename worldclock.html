<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>World Clock</title>
  <style>
    body {
      background-color: #fff0f5;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      min-height: 100vh;
      margin: 0;
    }

    .container {
      background-color: white;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      width: 90%;
      max-width: 600px;
      position: relative;
      margin-bottom: 20px;
    }

    h1 {
      text-align: center;
      color: #333;
    }

    select {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      margin: 20px 0;
      border-radius: 8px;
      border: 1px solid #ccc;
    }

    .clock {
      padding: 15px 0;
      border-top: 1px dashed #ddd;
    }

    .clock:first-of-type {
      border-top: none;
    }

    .city-name {
      font-size: 22px;
      font-weight: bold;
      color: #333;
    }

    .date {
      font-size: 14px;
      color: #888;
      margin-bottom: 5px;
    }

    .time {
      font-size: 36px;
      font-weight: bold;
      color: #000;
    }

    .am-pm {
      font-size: 16px;
      vertical-align: super;
      margin-left: 5px;
    }

    .refresh-button {
      position: absolute;
      bottom: 20px;
      left: 20px;
      background-color: #f8a9c3;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px 16px;
      cursor: pointer;
      font-size: 14px;
      transition: background-color 0.3s;
    }

    .refresh-button:hover {
      background-color: #f18bb2;
    }

    footer {
      font-size: 14px;
      color: #555;
      text-align: center;
      max-width: 600px;
      padding: 20px;
      line-height: 1.6;
    }

    footer a {
      color: #f18bb2;
      text-decoration: none;
      font-weight: 500;
    }

    footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>World Clock</h1>

    <select id="citySelector">
      <option value="">Select a city..</option>
      <option value="Asia/Tokyo">Tokyo</option>
      <option value="Europe/London">London</option>
      <option value="Australia/Sydney">Sydney</option>
      <option value="current">Current Location</option>
    </select>

    <div id="clocksContainer"></div>

    <button class="refresh-button" onclick="location.reload()">Refresh</button>
    <br>
    <footer>
        This World Clock project was coded by 
        <a href="https://github.com/Khalipha-Saliso">Khalipha Saliso</a>,
        open-sourced on
        <a href="https://github.com/Khalipha-Saliso/world-clock">GitHub</a>
        and hosted on
        <a href="https://worldtimeengine.netlify.app/">Netlify</a>.
      </footer>    
  </div>

  <script>
    const clocksContainer = document.getElementById("clocksContainer");
    const citySelector = document.getElementById("citySelector");

    let selectedZones = [
      { zone: "America/Los_Angeles", label: "Los Angeles" },
      { zone: "Europe/Paris", label: "Paris" }
    ];

    function formatTime(date) {
      let hours = date.getHours();
      const ampm = hours >= 12 ? 'PM' : 'AM';
      hours = hours % 12 || 12;
      const minutes = date.getMinutes().toString().padStart(2, '0');
      const seconds = date.getSeconds().toString().padStart(2, '0');
      return `${hours}:${minutes}:${seconds} <span class="am-pm">${ampm}</span>`;
    }

    function formatDate(date) {
      return date.toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric' });
    }

    async function getCurrentLocationInfo() {
      try {
        const response = await fetch("https://ipapi.co/json/");
        const data = await response.json();
        const city = data.city;
        const timezone = data.timezone;
        return { zone: timezone, label: city };
      } catch (error) {
        console.error("Could not get location info", error);
        return null;
      }
    }

    function updateClocks() {
      clocksContainer.innerHTML = '';
      selectedZones.forEach(entry => {
        const date = new Date(new Date().toLocaleString("en-US", { timeZone: entry.zone }));
        clocksContainer.innerHTML += `
          <div class="clock">
            <div class="city-name">${entry.label}</div>
            <div class="date">${formatDate(date)}</div>
            <div class="time">${formatTime(date)}</div>
          </div>`;
      });
    }

    setInterval(updateClocks, 1000);

    citySelector.addEventListener("change", async function () {
      const selectedValue = this.value;

      if (selectedValue === "current") {
        const currentLocation = await getCurrentLocationInfo();
        if (currentLocation && !selectedZones.find(z => z.zone === currentLocation.zone)) {
          selectedZones.push(currentLocation);
        }
      } else if (selectedValue) {
        const label = selectedValue.split("/")[1].replace("_", " ");
        if (!selectedZones.find(z => z.zone === selectedValue)) {
          selectedZones.push({ zone: selectedValue, label });
        }
      }
    });

    updateClocks();
  </script>
</body>
</html>




